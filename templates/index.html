{% extends "base.html" %}

{% block content %}
<section class="search-section">
    <h2>Roomie</h2>
<form method="get" action="{{ url_for('index') }}">
  <!-- Cinsiyet Filtresi -->
  <select name="cinsiyet">
    <option value="farketmez" {% if request.args.get('cinsiyet', 'farketmez') == 'farketmez' %}selected{% endif %}>Farketmez</option>
    <option value="Erkek" {% if request.args.get('cinsiyet') == 'Erkek' %}selected{% endif %}>Erkek</option>
    <option value="Kadın" {% if request.args.get('cinsiyet') == 'Kadın' %}selected{% endif %}>Kadın</option>
  </select>

  <!-- Fiyat Aralığı -->
  <input type="number" name="min_fiyat" placeholder="Min Fiyat" 
         value="{{ request.args.get('min_fiyat', '') }}">
  <input type="number" name="max_fiyat" placeholder="Max Fiyat"
         value="{{ request.args.get('max_fiyat', '') }}">

  <!-- Diğer Filtreler -->
  <label>
    <input type="checkbox" name="sigara" value="1" 
           {% if request.args.get('sigara') == '1' %}checked{% endif %}> Sigara İçen
  </label>
  <label>
    <input type="checkbox" name="alkol" value="1"
           {% if request.args.get('alkol') == '1' %}checked{% endif %}> Alkol Kullanan
  </label>
  <label>
    <input type="checkbox" name="evcil_hayvan" value="1"
           {% if request.args.get('evcil_hayvan') == '1' %}checked{% endif %}> Evcil Hayvan
  </label>

  <button type="submit">Filtrele</button>
  <a href="{{ url_for('index') }}">Filtreleri Temizle</a>
</form>
<div class="active-filters">
  {% if request.args %}
    <strong>Aktif Filtreler:</strong>
    {% for key, value in request.args.items() %}
      {% if value and key != 'page' %}
        <span class="badge">{{ key }}: {{ value }}</span>
      {% endif %}
    {% endfor %}
  {% endif %}
</div>
</section>

<section class="ilan-listesi">
    <h2>Son Eklenen İlanlar</h2>
    <div class="ilan-grid">
        {% for ilan in ilanlar %}
		<div class="ilan-karti" data-ilan-id="{{ ilan.id }}">
			<!-- Resim kısmı -->
			<div class="ilan-resim">
				{% if ilan.resimler %}
					{% set first_image = ilan.resimler.split(',')[0] %}
					<img src="{{ url_for('static', filename='uploads/' + first_image) if ('static/uploads/' + first_image)|file_exists else url_for('static', filename='images/placeholder.jpg') }}" 
						 alt="{{ ilan.baslik }}" class="ilan-resim-img">
				{% else %}
					<img src="{{ url_for('static', filename='images/placeholder.jpg') }}" 
						 alt="Resim Yok" class="ilan-resim-img">
				{% endif %}
			</div>
			
			<!-- Konum ve fiyat bilgileri -->
			<div class="ilan-alt-bilgi">
				<span class="ilan-konum">{{ ilan.konum }}</span>
				<span class="ilan-fiyat">{{ ilan.fiyat }} TL</span>
			</div>
			
			<!-- Beğenme butonları -->
			<div class="ilan-aksiyonlar">
				<button class="aksiyon-btn cay-btn" data-tip="cay">🍵 Çay Gönder</button>
				<button class="aksiyon-btn kahve-btn" data-tip="kahve">☕ Kahve Gönder</button>
			</div>
		</div>
        {% endfor %}
    </div>
</section>
{% endblock %}